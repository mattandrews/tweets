<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>mattpointblank‚Äôs Twitter Archive‚Äî‚Ññ 16,452</title>
		<meta name="description" content="The search tool in question: https://t.co/iTg9G5gZfl">

		<link rel="profile" href="https://microformats.org/profile/hatom">
		<link rel="stylesheet" href="/tweets/assets/style.css">
		<script src="/tweets/assets/script.js" type="module"></script>
		<script src="/tweets/assets/is-land.js" type="module"></script>

		
	</head>
	<body>
		<header>
			<h1 class="tweets-title"><a href="/tweets/"><img src="https://gravatar.com/avatar/63cfa1e95066a1c4bc66f6740cf9ab77?size=256" width="52" height="52" alt="mattpointblank‚Äôs avatar" class="tweet-avatar">mattpointblank‚Äôs Twitter Archive</a>‚Äî‚Ññ 16,452</h1>
			
			<ul class="tweets-nav">
			<li><a href="/tweets/newest/">‚á§ Newest<span class="sr-only"> Tweet</span></a></li>
			<li><a href="/tweets/1063725881330462721/">‚á† Newer<span class="sr-only"> Tweet</span></a></li>
			<li><a href="/tweets/1063707691334467584/">Older<span class="sr-only"> Tweet</span> ‚á¢</a></li>
		</ul>
		</header>
		<main>
			<ol class="tweets tweets-thread h-feed hfeed" data-pagefind-body="">
			<ol class="tweets-replies h-feed hfeed"><ol class="tweets-replies"><ol class="tweets-replies"><ol class="tweets-replies"><li id="1063706772559593472" class="tweet h-entry tweet-previous" data-pagefind-index-attrs="id">
		
			<div class="tweet-text e-content">Here is a story in three charts:

Two weeks ago, we launched a new search tool at work with 200,000+ results pages.

A few days ago, the CPU usage for the database powering the search started to look like this:

(eg. spiky, dangerous levels of high usage) <is-land on:visible=""><div class="tweet-medias"><a href="/tweets/img/OIllkI6fWX.jpeg"><img src="/tweets/img/OIllkI6fWX.jpeg" width="1200" height="362" alt="oh my god twitter doesn‚Äôt include alt text from images in their API" class="tweet-media u-featured" onerror="fallbackMedia(this)" loading="lazy" decoding="async"></a></div></is-land></div>
			<span class="tweet-metadata">
				<a href="/tweets/1063706772559593472/" class="tag tag-naked">Permalink</a>
				<a href="https://twitter.com/mattpointblank/status/1063706772559593472" class="tag tag-icon u-url" data-pagefind-index-attrs="href"><span class="sr-only">On twitter.com </span><img src="https://v1.indieweb-avatar.11ty.dev/https%3A%2F%2Fx.com%2F/" alt="Twitter logo" width="27" height="27"></a>
				
				<a href="/tweets/" class="tag tag-naked tag-lite tag-avatar"><img src="https://gravatar.com/avatar/63cfa1e95066a1c4bc66f6740cf9ab77?size=256" width="52" height="52" alt="mattpointblank‚Äôs avatar" class="tweet-avatar"></a>
				<span class="tag tag-lite tag-retweet">‚ôªÔ∏è 4<span class="sr-only"> Retweets</span></span>
					<span class="tag tag-lite tag-favorite">‚ù§Ô∏è 8<span class="sr-only"> Favorites</span></span>
				<time class="tag tag-naked tag-lite dt-published" datetime="2018-11-17T08:13:51.000Z">2018 Nov 17</time>
				<span class="tag tag-naked tag-lite sr-only">Mood +<strong class="tweet-sentiment">1</strong> üôÇ</span>
			</span>
		</li></ol><li id="1063707065112281089" class="tweet h-entry tweet-previous" data-pagefind-index-attrs="id">
		<a href="/tweets/1063706772559593472/" class="tweet-pretext u-in-reply-to">‚Ä¶in reply to @mattpointblank</a>
			<div class="tweet-text e-content">We spent a few days tuning performance, adding indexes, tweaking queries etc. No difference. We looked at the logs ‚Äì lots of Googlebot traffic. We checked our Google Search Console.

Googlebot was very, very hungry. And we'd just given it almost half a million new pages. <is-land on:visible=""><div class="tweet-medias"><a href="/tweets/img/RkxdRu1WUy.jpeg"><img src="/tweets/img/RkxdRu1WUy.jpeg" width="1007" height="370" alt="oh my god twitter doesn‚Äôt include alt text from images in their API" class="tweet-media u-featured" onerror="fallbackMedia(this)" loading="lazy" decoding="async"></a></div></is-land></div>
			<span class="tweet-metadata">
				<a href="/tweets/1063707065112281089/" class="tag tag-naked">Permalink</a>
				<a href="https://twitter.com/mattpointblank/status/1063707065112281089" class="tag tag-icon u-url" data-pagefind-index-attrs="href"><span class="sr-only">On twitter.com </span><img src="https://v1.indieweb-avatar.11ty.dev/https%3A%2F%2Fx.com%2F/" alt="Twitter logo" width="27" height="27"></a>
				
				<a href="/tweets/" class="tag tag-naked tag-lite tag-avatar"><img src="https://gravatar.com/avatar/63cfa1e95066a1c4bc66f6740cf9ab77?size=256" width="52" height="52" alt="mattpointblank‚Äôs avatar" class="tweet-avatar"></a>
				
				<time class="tag tag-naked tag-lite dt-published" datetime="2018-11-17T08:15:01.000Z">2018 Nov 17</time>
				<span class="tag tag-naked tag-lite sr-only">Mood <strong class="tweet-sentiment">-1</strong> üôÅ</span>
			</span>
		</li></ol><li id="1063707414535512065" class="tweet h-entry tweet-previous" data-pagefind-index-attrs="id">
		<a href="/tweets/1063707065112281089/" class="tweet-pretext u-in-reply-to">‚Ä¶in reply to @mattpointblank</a>
			<div class="tweet-text e-content">We realised that each of the pages it was crawling made a call to a "related" endpoint which was slow/expensive to render. We quickly disabled this. 

Here's the almost immediate impact on CPU: <is-land on:visible=""><div class="tweet-medias"><a href="/tweets/img/F03qDhLn2c.jpeg"><img src="/tweets/img/F03qDhLn2c.jpeg" width="1200" height="556" alt="oh my god twitter doesn‚Äôt include alt text from images in their API" class="tweet-media u-featured" onerror="fallbackMedia(this)" loading="lazy" decoding="async"></a></div></is-land></div>
			<span class="tweet-metadata">
				<a href="/tweets/1063707414535512065/" class="tag tag-naked">Permalink</a>
				<a href="https://twitter.com/mattpointblank/status/1063707414535512065" class="tag tag-icon u-url" data-pagefind-index-attrs="href"><span class="sr-only">On twitter.com </span><img src="https://v1.indieweb-avatar.11ty.dev/https%3A%2F%2Fx.com%2F/" alt="Twitter logo" width="27" height="27"></a>
				
				<a href="/tweets/" class="tag tag-naked tag-lite tag-avatar"><img src="https://gravatar.com/avatar/63cfa1e95066a1c4bc66f6740cf9ab77?size=256" width="52" height="52" alt="mattpointblank‚Äôs avatar" class="tweet-avatar"></a>
				
				<time class="tag tag-naked tag-lite dt-published" datetime="2018-11-17T08:16:25.000Z">2018 Nov 17</time>
				<span class="tag tag-naked tag-lite sr-only">Mood <strong class="tweet-sentiment">0</strong></span>
			</span>
		</li></ol><li id="1063707691334467584" class="tweet h-entry tweet-previous" data-pagefind-index-attrs="id">
		<a href="/tweets/1063707414535512065/" class="tweet-pretext u-in-reply-to">‚Ä¶in reply to @mattpointblank</a>
			<div class="tweet-text e-content">Moral of the story: assume all robots are ceaseless, greed-powered machines intent on grinding all of your servers into dust, and code appropriately.</div>
			<span class="tweet-metadata">
				<a href="/tweets/1063707691334467584/" class="tag tag-naked">Permalink</a>
				<a href="https://twitter.com/mattpointblank/status/1063707691334467584" class="tag tag-icon u-url" data-pagefind-index-attrs="href"><span class="sr-only">On twitter.com </span><img src="https://v1.indieweb-avatar.11ty.dev/https%3A%2F%2Fx.com%2F/" alt="Twitter logo" width="27" height="27"></a>
				
				<a href="/tweets/" class="tag tag-naked tag-lite tag-avatar"><img src="https://gravatar.com/avatar/63cfa1e95066a1c4bc66f6740cf9ab77?size=256" width="52" height="52" alt="mattpointblank‚Äôs avatar" class="tweet-avatar"></a>
				<span class="tag tag-lite tag-retweet">‚ôªÔ∏è 1<span class="sr-only"> Retweets</span></span>
					<span class="tag tag-lite tag-favorite">‚ù§Ô∏è 8<span class="sr-only"> Favorites</span></span>
				<time class="tag tag-naked tag-lite dt-published" datetime="2018-11-17T08:17:31.000Z">2018 Nov 17</time>
				<span class="tag tag-naked tag-lite sr-only">Mood +<strong class="tweet-sentiment">2</strong> üôÇ</span>
			</span>
		</li></ol>
			<li id="1063707832602771456" class="tweet h-entry" data-pagefind-index-attrs="id">
		<a href="/tweets/1063707691334467584/" class="tweet-pretext u-in-reply-to">‚Ä¶in reply to @mattpointblank</a>
			<div class="tweet-text e-content" data-pagefind-body="">The search tool in question: <a href="https://www.biglotteryfund.org.uk/funding/grants" class="tweet-url" data-pagefind-index-attrs="href">biglotteryfund.org.uk/funding/grants</a><is-land on:visible=""><div class="tweet-medias"><template data-island=""><a href="https://www.biglotteryfund.org.uk/funding/grants"><img src="https://v1.opengraph.11ty.dev/https%3A%2F%2Fwww.biglotteryfund.org.uk%2Ffunding%2Fgrants/small/onerror/" alt="OpenGraph image for biglotteryfund.org.uk/funding/grants" loading="lazy" decoding="async" width="375" height="197" class="tweet-media tweet-media-og" onerror="this.parentNode.remove()"></a></template></div></is-land></div>
			<span class="tweet-metadata">
				
				<a href="https://twitter.com/mattpointblank/status/1063707832602771456" class="tag tag-icon u-url" data-pagefind-index-attrs="href"><span class="sr-only">On twitter.com </span><img src="https://v1.indieweb-avatar.11ty.dev/https%3A%2F%2Fx.com%2F/" alt="Twitter logo" width="27" height="27"></a>
				
				<a href="/tweets/" class="tag tag-naked tag-lite tag-avatar"><img src="https://gravatar.com/avatar/63cfa1e95066a1c4bc66f6740cf9ab77?size=256" width="52" height="52" alt="mattpointblank‚Äôs avatar" class="tweet-avatar"></a>
				
				<time class="tag tag-naked tag-lite dt-published" datetime="2018-11-17T08:18:04.000Z">2018 Nov 17</time>
				<span class="tag tag-naked tag-lite sr-only">Mood <strong class="tweet-sentiment">0</strong></span>
			</span>
		</li>
			
		</ol>
		</main>
		<footer>
			<p>An open source project from <a href="https://github.com/tweetback">tweetback</a>.</p>
		</footer>
	</body>
</html>